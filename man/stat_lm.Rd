% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stat_lm.R
\name{stat_lm}
\alias{stat_lm}
\title{Linear Model for morphometric data}
\usage{
stat_lm(data, formula, ...)
}
\arguments{
\item{data}{A tibble with coefficient and/or scalar columns}

\item{formula}{A formula specifying the model. Can be:
\itemize{
\item Shape regression: \code{coe ~ length} (shape depends on predictors)
\item Response regression: \code{length ~ coe} (response depends on shape)
\item Multivariate response: \code{cbind(length, width) ~ coe}
\item Multiple predictors: \code{coe ~ length + temperature}
\item Interactions: \code{coe ~ length * temperature}
}}

\item{...}{Additional arguments passed to \code{\link[stats:lm]{stats::lm()}}}
}
\value{
An object of class \code{c("stat_lm", "momstats")} containing:
\itemize{
\item \code{data}: Original tibble (unchanged)
\item \code{model}: The \code{\link[stats:lm]{stats::lm()}} object
\item \code{method}: "lm"
\item \code{direction}: "shape_regression" or "response_regression"
\item \code{call}: The function call
\item \code{formula}: Formula used
\item \code{response_col}: Response column name(s)
\item \code{predictor_cols}: Predictor column name(s)
\item \code{r_squared}: R^2 value(s)
\item \code{adj_r_squared}: Adjusted R^2 value(s)
}
}
\description{
Fit linear models with coefficient data as response or predictor.
}
\details{
\code{stat_lm()} provides a unified interface for linear modeling with morphometric data.
\subsection{Formula directions}{

The function automatically detects model direction from the formula:

\strong{Shape regression} (\code{coe ~ predictors}):
\itemize{
\item Fits multivariate regression with all harmonics as response
\item Proper treatment of shape as correlated multivariate outcome
\item Tests whether predictors affect shape
\item Example: \code{boteft \%>\% stat_lm(coe ~ length)}
}

\strong{Response regression} (\code{response ~ coe}):
\itemize{
\item Fits regression with unfolded harmonics as predictors
\item Tests whether shape predicts a response variable
\item Example: \code{boteft \%>\% stat_lm(length ~ coe)}
}

\strong{Multivariate response} (\code{cbind(y1, y2) ~ coe}):
\itemize{
\item Fits multivariate regression with multiple responses
\item Example: \code{boteft \%>\% stat_lm(cbind(length, width) ~ coe)}
}
}

\subsection{Interactions and multiple predictors}{

Standard R formula syntax is supported:
\itemize{
\item \code{coe ~ length + temperature}: Additive effects
\item \code{coe ~ length * temperature}: With interaction
\item \code{coe ~ poly(length, 2)}: Polynomial terms
}
}

\subsection{Getting results}{

Use \code{\link[=collect]{collect()}} to add predictions to your data:

\if{html}{\out{<div class="sourceCode r">}}\preformatted{lm_fit <- boteft \%>\% stat_lm(coe ~ length)
boteft_pred <- collect(lm_fit)  # Adds fitted values
}\if{html}{\out{</div>}}

Use \code{\link[=transduce]{transduce()}} to predict at new positions:

\if{html}{\out{<div class="sourceCode r">}}\preformatted{new_shapes <- transduce(lm_fit, tibble::tibble(length = seq(50, 150, by = 10)))
}\if{html}{\out{</div>}}
}
}
\examples{
\dontrun{
# Shape regression
lm1 <- boteft \%>\% stat_lm(coe ~ length)
lm2 <- boteft \%>\% stat_lm(coe ~ length + type)
lm3 <- boteft \%>\% stat_lm(coe ~ length * type)

# Response regression
lm4 <- boteft \%>\% stat_lm(length ~ coe)

# Multivariate response
lm5 <- boteft \%>\% stat_lm(cbind(length, width) ~ coe)

# Plot results
plot(lm1)
plot(lm1, type = "residuals")

# Get predictions
boteft_pred <- collect(lm1)

# Transduce to new values
new_shapes <- transduce(lm1, tibble::tibble(length = seq(50, 150, by = 10)))
}

}
\seealso{
\code{\link[stats:lm]{stats::lm()}}, \code{\link[=collect.stat_lm]{collect.stat_lm()}}, \code{\link[=plot.stat_lm]{plot.stat_lm()}}, \code{\link[=transduce.stat_lm]{transduce.stat_lm()}}
}
