% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stat_lda.R
\name{stat_lda}
\alias{stat_lda}
\title{Linear Discriminant Analysis for morphometric data}
\usage{
stat_lda(data, formula, ...)
}
\arguments{
\item{data}{A tibble with coefficient columns}

\item{formula}{A formula or bare column name specifying response and predictors:
\itemize{
\item Bare name: \code{species} → auto-detects all coe columns
\item Formula: \code{species ~ .} → all coe columns
\item Formula: \code{species ~ . + length} → all coe + covariate
\item Formula: \code{species ~ coe1} → specific coe column
\item Formula: \code{species ~ coe1 + coe2 + length} → multiple specific
}}

\item{...}{Additional arguments passed to \code{\link[MASS:lda]{MASS::lda()}}}
}
\value{
An object of class \code{c("stat_lda", "momstats")} containing:
\itemize{
\item \code{data}: Original tibble (unchanged)
\item \code{model}: List containing both the LDA model and CV predictions
\item \code{method}: "lda"
\item \code{call}: The function call
\item \code{formula}: Formula used
\item \code{response_col}: Name of response column
\item \code{predictor_cols}: All predictor column names (coe + others)
\item \code{kept_predictor_cols}: Predictor columns after removing collinear
\item \code{n_groups}: Number of groups
\item \code{n_ld}: Number of discriminant functions
}
}
\description{
Perform LDA on coefficient data from morphometric analyses. Supports both
bare response names (auto-detects all coe columns) and full formula syntax.
}
\details{
\code{stat_lda()} provides a unified interface for LDA on morphometric coefficient
data. It handles:
\itemize{
\item \strong{Flexible formula syntax}: Bare response names or full formulas
\item \strong{Automatic coefficient detection}: Finds all \code{coe} columns via class
\item \strong{Coefficient unfolding}: Expands list-columns to individual harmonic columns
\item \strong{Multiple coefficient types}: Can combine different coefficient columns
\item \strong{Covariates}: Add non-morphometric predictors (size, environmental variables)
\item \strong{Cross-validation}: Always runs with CV=TRUE for reliable predictions
}
\subsection{Formula syntax}{

The formula specifies response and predictors:
\itemize{
\item \code{species} → Response only, auto-detect all coe columns
\item \code{species ~ .} → All coe columns (explicit)
\item \code{species ~ coe1} → Specific coe column
\item \code{species ~ coe1 + coe2} → Multiple specific coe columns
\item \code{species ~ . + length} → All coe plus a covariate
}
}

\subsection{Centering and scaling}{

LDA internally centers and scales the data as part of the algorithm.
No manual preprocessing is needed.
}

\subsection{Cross-validation}{

The function runs LDA twice:
\enumerate{
\item \code{CV = FALSE}: Builds the full model (discriminant functions, loadings)
\item \code{CV = TRUE}: Generates cross-validated predictions
}

Both are stored in \verb{$model} for easy access.
}

\subsection{Getting results}{

Use \code{\link[=collect]{collect()}} to add predictions to your data:

\if{html}{\out{<div class="sourceCode r">}}\preformatted{lda <- boteft \%>\% stat_lda(type)
boteft_pred <- collect(lda)  # Adds pred, prob columns
}\if{html}{\out{</div>}}
}
}
\examples{
\dontrun{
# Basic LDA - auto-detects all coe columns
lda1 <- boteft \%>\% stat_lda(type)

# Explicit formula
lda2 <- boteft \%>\% stat_lda(type ~ .)

# Specific coe column
lda3 <- boteft \%>\% stat_lda(type ~ coe)

# With covariate
lda4 <- boteft \%>\% stat_lda(type ~ . + length)

# Add predictions to data
boteft_pred <- collect(lda1)  # Adds pred, prob

# Add LD scores too
boteft_ld <- collect(lda1, retain = 2)  # Adds pred, prob, LD1, LD2

# Plot results
plot(lda1)  # Discrimination plot (default)
plot(lda1, type = "loadings")
plot(lda1, color = type)  # Color by true groups
plot(lda1, labels = pred)  # Label by predictions
}

}
\seealso{
\code{\link[MASS:lda]{MASS::lda()}}, \code{\link[=collect.stat_lda]{collect.stat_lda()}}, \code{\link[=plot.stat_lda]{plot.stat_lda()}}
}
